import pandas as pd
import json
from os import listdir


directories = [
    "C:/Users/HP/Downloads/flight data/2016_original/2016",
    "C:/Users/HP/Downloads/flight data/2016_original/2017"
]

# List all flight data from 2016 to 2017
all_data = []


for directory in directories:
    
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith(".csv"):
                file_path = os.path.join(root, file)
                df = pd.read_csv(file_path)
                all_data.append(df)


flight_data = pd.concat(all_data, ignore_index=True)

recommended_columns = ['FlightDate', 'Quarter', 'Year', 'Month', 'DayofMonth', 'DepTime', 'DepDel15', 'CRSDepTime', 'DepDelayMinutes', 'Origin', 'Dest', 'ArrTime', 'CRSArrTime', 'ArrDel15', 'ArrDelayMinutes']


flight_data = flight_data[recommended_columns]


#now let's do similar thing with the weather data



root_directory = "C:/Users/HP/Downloads/airport data"

all_weather_data = []


for root, dirs, files in os.walk(root_directory):
    for file in files:
        if file.endswith(".json"):
            file_path = os.path.join(root, file)
            with open(file_path, 'r') as f:
                data = json.load(f)
                weather_data = data.get('data', {}).get('weather', [])
                airport_name = data.get('data', {}).get('request', [{}])[0].get('query', '')
                for entry in weather_data:
                    hourly_data = entry.get('hourly', [])
                    weather_df = pd.DataFrame(hourly_data)
                    weather_df['airport'] = airport_name
                    weather_df['date'] = entry.get('date', '')
                    all_weather_data.append(weather_df)


weather_data = pd.concat(all_weather_data, ignore_index=True)


desired_columns = ['windspeedKmph', 'winddirDegree', 'weatherCode', 'precipMM', 
                   'visibility', 'pressure', 'cloudcover', 'DewPointF', 
                   'WindGustKmph', 'tempF', 'WindChillF', 'humidity', 
                   'time', 'date', 'airport']
weather_data = weather_data[desired_columns]





